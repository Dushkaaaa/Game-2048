const t=new class{constructor(t){this.defaultState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board=t||JSON.parse(JSON.stringify(this.defaultState)),this.score=0,this.status="idle",this.rows=4,this.cols=4}arraysEqual(t,e){return JSON.stringify(t)===JSON.stringify(e)}move(t){let e={left:t=>t,right:t=>t.slice().reverse(),up:t=>t,down:t=>t.slice().reverse()},s={left:t=>t,right:t=>t.slice().reverse(),up:t=>t,down:t=>t.slice().reverse()},r=!1;if("left"===t||"right"===t)for(let i=0;i<this.rows;i++){let o=e[t](this.board[i]).filter(t=>0!==t);for(let t=0;t<o.length-1;t++)o[t]===o[t+1]&&(o[t]*=2,this.score+=o[t],o[t+1]=0,r=!0);for(o=o.filter(t=>0!==t);o.length<this.rows;)o.push(0);o=s[t](o),this.arraysEqual(this.board[i],o)||(r=!0),this.board[i]=o}else for(let i=0;i<this.cols;i++){let o=this.board.map(t=>t[i]),a=(o=e[t](o)).filter(t=>0!==t);for(let t=0;t<a.length-1;t++)a[t]===a[t+1]&&(a[t]*=2,this.score+=a[t],a[t+1]=0,r=!0);for(a=a.filter(t=>0!==t);a.length<this.rows;)a.push(0);a=s[t](a),this.arraysEqual(this.board.map(t=>t[i]),a)||(r=!0);for(let t=0;t<this.rows;t++)this.board[t][i]=a[t]}"playing"===this.status&&r&&this.addRandomTile()}moveLeft(){this.move("left")}moveRight(){this.move("right")}moveUp(){this.move("up")}moveDown(){this.move("down")}getScore(){return this.score}getState(){return this.board}getStatus(){return"idle"===this.status?"idle":this.checkWin()?"win":this.checkLose()?"lose":"playing"}checkWin(){return this.board.some(t=>t.includes(2048))}checkLose(){if(this.board.some(t=>t.includes(0)))return!1;for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}start(){this.board=JSON.parse(JSON.stringify(this.defaultState)),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}addRandomTile(){let t=[];for(let e=0;e<this.rows;e++)for(let s=0;s<this.cols;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}restart(){return this.start()}};function e(){let e=t.getState();document.querySelectorAll(".field-row").forEach((t,s)=>{t.querySelectorAll(".field-cell").forEach((t,r)=>{let i=e[s][r];t.textContent=0===i?"":i,t.className="field-cell",0!==i&&t.classList.add(`field-cell--${i}`)})}),document.querySelector(".game-score").textContent=t.getScore(),function(){let e=t.getStatus(),s=document.querySelector(".message-start"),r=document.querySelector(".message-win"),i=document.querySelector(".message-lose");s.classList.add("hidden"),r.classList.add("hidden"),i.classList.add("hidden"),"idle"===e?s.classList.remove("hidden"):"win"===e?r.classList.remove("hidden"):"lose"===e&&i.classList.remove("hidden")}()}document.addEventListener("keydown",s=>{switch(s.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;default:return 0}e()});const s=document.querySelector(".start");s.addEventListener("click",()=>{s.classList.contains("start")&&(s.classList.replace("start","restart"),s.textContent="Restart"),t.start(),e()});
//# sourceMappingURL=index.22c05c7e.js.map
